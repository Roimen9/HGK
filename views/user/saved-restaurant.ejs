<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="preconnect" href="https://res.cloudinary.com"/>
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>

                            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

    <script defer>
        (function(h,o,t,j,a,r){
            h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
            h._hjSettings={hjid:5297368,hjsv:6};
            a=o.getElementsByTagName('head')[0];
            r=o.createElement('script');r.async=1;
            r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
            a.appendChild(r);
        })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
</head>
<body class="bg-body-tertiary">
    <%- include('../partials/user-header') %>
    <div class="container mt-5 pt-4">
        <div class="row align-items-start">
            <div id="carouselExampleIndicator" class="carousel slide col-lg-6 col-12 mb-lg-0 mb-2 mt-5">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#carouselExampleIndicator" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicator" data-bs-slide-to="1" aria-label="Slide 2" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicator" data-bs-slide-to="2" aria-label="Slide 3" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicator" data-bs-slide-to="3" aria-label="Slide 4" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicator" data-bs-slide-to="4" aria-label="Slide 5" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                </div>
                <div class="carousel-inner gap-5">
                    <div class="carousel-item active">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT0MmphFrUjMg2WzWroxXu7vxSVsGXCQ6PgQQ&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                    <div class="carousel-item">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT0MmphFrUjMg2WzWroxXu7vxSVsGXCQ6PgQQ&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                    <div class="carousel-item">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT0MmphFrUjMg2WzWroxXu7vxSVsGXCQ6PgQQ&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                    <div class="carousel-item">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT0MmphFrUjMg2WzWroxXu7vxSVsGXCQ6PgQQ&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                    <div class="carousel-item">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT0MmphFrUjMg2WzWroxXu7vxSVsGXCQ6PgQQ&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                    
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicator" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden d-none">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicator" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>
        <div class="container mt-3">
                <input type="text" value="<%= row.id %>" style="display: none;" id="ID">
                <div class="title d-flex align-items-center gap-2 justify-space-between">
                    <div class="fs-4 lead info"></div>
                    <div class="restaurant-name h3"><%= row.name %></div>
                    <div style="border-left: 1px solid black; height: 25px;"></div>
                    <div class="lead fs-5 me-5 pe-5"><%= row.category %></div>
                    <i class="fas fa-bookmark fs-4 marker" style="color: yellow;"></i> 
                </div>
                <hr>
                <div class="row d-flex align-items-start">
                    <div class="col-lg-7 col-12 mb-lg-0 mb-4">
                        <div class="description h4">Description</div>
                        <div class="lead fs-4"><%= row.description %></div>
                        <div class="status" style="display: none;">saved</div>
                        <div class="mt-2">
                            <i class="far fa-map fs-4" style="outline-width: 1px;"></i>
                            <i class="fas fa-phone-alt fs-4"></i>
                            <i class="far fa-envelope fs-4"></i>
                            <i class="fas fa-globe-africa fs-4"></i>
                            <i class="fab fa-instagram fs-4"></i>
                            <i class="bi bi-instagram fs-4"></i>
                            

                        </div>
                    </div>
                    <hr class="d-lg-none">
                    <div id="carouselExampleIndicators" class="carousel slide col-lg-5 col-12">
                    <div class="h4">Menu</div>
                    <div class="carousel-indicators">
                        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="3" aria-label="Slide 4" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="4" aria-label="Slide 5" style="border-radius: 50%; height: 8px; width: 8px;"></button>
                </div>
                
                <div class="carousel-inner gap-5">
                    <div class="carousel-item active">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRcTBOJf_gOTW2dh5llu8e7AJHOhxjU39mYEw&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                    <div class="carousel-item">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTIDryKJTCtZwD89iitC4pIfkjKUX7DmZzvWg&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                    <div class="carousel-item">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRcTBOJf_gOTW2dh5llu8e7AJHOhxjU39mYEw&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                    <div class="carousel-item">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTIDryKJTCtZwD89iitC4pIfkjKUX7DmZzvWg&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                    <div class="carousel-item">
                       <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRcTBOJf_gOTW2dh5llu8e7AJHOhxjU39mYEw&s" class="d-block w-100 card-img-top bg-danger-subtle rounded-4" alt="" loading="lazy">
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden d-none">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
                </div>
            </div>
    <%- include('../partials/footer') %>
</body>
    <script>
        const id = document.getElementById('ID').value
        const marker = document.querySelector('.marker')
        const info = document.querySelector('.info')
        const status = document.querySelector('.status')

        async function save() {
            marker.style.color = 'yellow'
            status.textContent = 'saved'
           const options = {
                method : 'POST'
           }

           try {
            const response = await fetch(`/user/save/${id}`, options)
            if (!response) return new Error('Internal Server error')
                const data = await response.json()
                console.log(data)
           } catch (error) {
                console.log('Error', error)
                info.textContent = 'Failed to save restaurant'
           }
        }

        async function unsave() {
            marker.style.color = 'black'
            status.textContent = 'unsaved'
           const options = {
                method : 'DELETE'
           }

           try {
            const response = await fetch(`/user/remove/${id}`, options)
            if (!response) return new Error('Internal Server error')
                const data = await response.json()
                console.log(data)
           } catch (error) {
                console.log('Error', error)
                info.textContent = 'Failed to save restaurant'
           }
        }

        function mark() {
           if(status.textContent === 'saved') {
               unsave()
            } else {
               save()
           }           
        }

        marker.onclick = mark
        
    </script>
</html>