<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head>
<body class="bg-body-tertiary">
    <%- include('../partials/admin-header') %>
    <div class="container mt-md-5 mt-1 pt-5">
        <div class="box mt-4 pt-5 mb-3">
            <div class="row align-items-center justify-content-center gap-5">
                <div class="card col-lg-3 col-md-5 col-10 p-2 rounded-4 shadow border border-dark-subtle border-1">
                    <h3 class="card-title text-center">Users</h3>
                    <h4 class="fs-4 p-3 text-center"><%= users %></h4>
                </div>         
                <div class="card col-lg-3 col-md-5 col-10 p-2 rounded-4 shadow border border-dark-subtle border-1">
                    <h3 class="card-title text-center">Restaurants</h3>
                    <h4 class="fs-4 p-3 text-center"><%= restaurants %></h4>
                </div> 
                <!-- <div class="card col-lg-3 col-md-5 col-10 p-2 rounded-4 shadow border border-dark-subtle border-1">
                    <h3 class="card-title text-center">Sold cars</h3>
                    <h4 class="fs-4 p-3 text-center"><%=  %></h4>
                </div> -->
                <input type="text" class="data" value="<%= dayAxes %>" style="display: none;">
            </div>
        </div>
        <canvas id="myChart" height="88px"></canvas>
    </div>
</body>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Parse the counts object sent from backend
        const counts = JSON.parse(document.querySelector('.data').value);

        // Extract keys (dates) and values (number of signups)
        const labels = Object.keys(counts);
        const values = Object.values(counts);
        console.log(labels)
        const index = []
        labels.forEach(label => {
            let num = parseInt(label)
            index.push(num)
        })
        console.log(index)
        const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
        const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Sunday']

        const label = []
        index.forEach(i => {
            label.push(days[i])
        })

        // Draw the line chart
        const ctx = document.getElementById('myChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: label,
                datasets: [{
                    label: 'User Signups',
                    data: values,
                    borderColor: 'black',
                    borderWidth : 2,
                    backgroundColor: 'transparent',
                    fill: true,
                    tension: 0 // makes it smooth/curved
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x : {
                        title : {
                            display : true,
                            text : 'Date'
                        }
                    },
                    y: {
                        beginAtZero: true,
                        title : {
                            display : true,
                            text : 'User sign-ups'
                        }
                    }
                }
            }
        });
    </script>
</html>